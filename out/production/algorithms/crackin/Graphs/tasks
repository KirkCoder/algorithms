1. bfs to points road
2. 4.2 for not unique values
3. topological search
4. read black tree